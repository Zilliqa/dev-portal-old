(window.webpackJsonp=window.webpackJsonp||[]).push([[138],{240:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return b})),n.d(t,"metadata",(function(){return l})),n.d(t,"rightToc",(function(){return c})),n.d(t,"default",(function(){return o}));var a=n(2),i=n(6),r=(n(0),n(298)),b={id:"dev-rentonzilliqa-transitions",title:"Transitions",keywords:["scilla","transitions","rentonzilliqa"],description:"The Transitions of the Scilla Contract for the RentOnZilliqa Application"},l={id:"dev/dev-rentonzilliqa-transitions",isDocsHomePage:!1,title:"Transitions",description:"The Transitions of the Scilla Contract for the RentOnZilliqa Application",source:"@site/docs/dev/dev-rentonzilliqa-transitions.md",permalink:"/docs/dev/dev-rentonzilliqa-transitions",editUrl:"https://github.com/Zilliqa/dev-portal/tree/master/docs/dev/dev-rentonzilliqa-transitions.md",sidebar:"DevelopersSidebar",previous:{title:"Procedures",permalink:"/docs/dev/dev-rentonzilliqa-procedures"},next:{title:"Introduction to the frontend",permalink:"/docs/dev/dev-rentonzilliqa-frontend"}},c=[{value:"User Transitions",id:"user-transitions",children:[{value:"<code>create_user</code>",id:"create_user",children:[]}]},{value:"Listing Transitions",id:"listing-transitions",children:[{value:"<code>create_listing</code>",id:"create_listing",children:[]},{value:"<code>update_listing</code>",id:"update_listing",children:[]},{value:"<code>delete_listing</code>",id:"delete_listing",children:[]},{value:"<code>book_listing</code>",id:"book_listing",children:[]},{value:"<code>claim_rent</code>",id:"claim_rent",children:[]}]},{value:"Owner Transitions",id:"owner-transitions",children:[{value:"<code>claim_commission</code>",id:"claim_commission",children:[]},{value:"<code>update_commission</code>",id:"update_commission",children:[]},{value:"<code>update_night_duration</code>",id:"update_night_duration",children:[]}]}],s={rightToc:c};function o(e){var t=e.components,n=Object(i.a)(e,["components"]);return Object(r.b)("wrapper",Object(a.a)({},s,n,{components:t,mdxType:"MDXLayout"}),Object(r.b)("hr",null),Object(r.b)("p",null,"We finally get to the transitions in the Smart Contract. We group the transitions in the following types. ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/Quinence/zilliqa-fullstack-app-rentOnZilliqa/blob/main/src/scilla/RentOnZilliqa.scilla"}),"The source code"),"."),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"#user-transitions"}),"User Transitions")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"#listing-transitions"}),"Listing Transitions")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"#owner-transitions"}),"Owner Transitions"))),Object(r.b)("h2",{id:"user-transitions"},"User Transitions"),Object(r.b)("h3",{id:"create_user"},Object(r.b)("inlineCode",{parentName:"h3"},"create_user")),Object(r.b)("p",null,"This transition accepts the ",Object(r.b)("inlineCode",{parentName:"p"},"name")," and ",Object(r.b)("inlineCode",{parentName:"p"},"role")," of the new user."),Object(r.b)("p",null,"If the user already exists, the ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"dev-rentonzilliqa-library#account-codes"}),Object(r.b)("inlineCode",{parentName:"a"},"user_exists"))," message is sent back."),Object(r.b)("p",null,"If not, the ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"dev-rentonzilliqa-mutable-variables#user-details-fields"}),Object(r.b)("inlineCode",{parentName:"a"},"user_name"))," and ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"dev-rentonzilliqa-mutable-variables#user-details-fields"}),Object(r.b)("inlineCode",{parentName:"a"},"user_role"))," fields are set. The ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"dev-rentonzilliqa-library#account-codes"}),Object(r.b)("inlineCode",{parentName:"a"},"user_created"))," message is sent back."),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Arguments"),Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Description"),Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Type"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"name")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"The name of the user"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"String"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"role")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"The role of the user",Object(r.b)("br",null),"(",Object(r.b)("inlineCode",{parentName:"td"},"0"),": Renter, ",Object(r.b)("inlineCode",{parentName:"td"},"1"),": Host)"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"Uint32"))))),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-ocaml"}),"transition create_user (name: String, role: Uint32)\n  user_exists_check <- exists user_name[_sender];\n  match user_exists_check with\n  | True =>\n    send_message zero user_exists\n  | False =>\n    user_name[_sender] := name;\n    user_role[_sender] := role;\n    send_message zero user_created\n  end\nend\n")),Object(r.b)("br",null),Object(r.b)("h2",{id:"listing-transitions"},"Listing Transitions"),Object(r.b)("p",null,"This group of transitions is used in the transitions that a host account user may use to manage their listings."),Object(r.b)("h3",{id:"create_listing"},Object(r.b)("inlineCode",{parentName:"h3"},"create_listing")),Object(r.b)("p",null,"This transition is used by a host user to create a listing."),Object(r.b)("p",null,"The ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"dev-rentonzilliqa-mutable-variables#user-details-fields"}),Object(r.b)("inlineCode",{parentName:"a"},"user_role"))," is checked."),Object(r.b)("p",null,"The ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"dev-rentonzilliqa-mutable-variables#owner-fields"}),Object(r.b)("inlineCode",{parentName:"a"},"listing_id_generator"))," is used to set a new id for the listing, after which it is incremented."),Object(r.b)("p",null,"The ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"dev-rentonzilliqa-procedures#set_listing_details"}),Object(r.b)("inlineCode",{parentName:"a"},"set_listing_details"))," procedure is called to create the listing, and some of the listing fields are initialised, including ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"dev-rentonzilliqa-mutable-variables#listing-details-fields"}),Object(r.b)("inlineCode",{parentName:"a"},"listing_host")),", ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"dev-rentonzilliqa-mutable-variables#user-details-fields"}),Object(r.b)("inlineCode",{parentName:"a"},"listing_rented_till")),", and ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"dev-rentonzilliqa-mutable-variables#user-details-fields"}),Object(r.b)("inlineCode",{parentName:"a"},"listing_accumulated_rent")),"."),Object(r.b)("p",null,"The ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"dev-rentonzilliqa-library#host-account-codes"}),Object(r.b)("inlineCode",{parentName:"a"},"listing_created"))," message is sent on success."),Object(r.b)("p",null,"On failure, the ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"dev-rentonzilliqa-library#renter-account-codes"}),Object(r.b)("inlineCode",{parentName:"a"},"user_is_renter"))," or ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"dev-rentonzilliqa-library#account-codes"}),Object(r.b)("inlineCode",{parentName:"a"},"user_does_not_exist"))," messages are sent back."),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Arguments"),Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Description"),Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Type"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"name")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"The name of the listing"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"String"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"description")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"The description of the listing"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"String"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"price")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"The price of the listing"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"Uint128"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"rooms")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"The number of rooms in the listing"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"Uint32"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"bathrooms")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"The number of bathrooms in the listing"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"Uint32"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"image")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"A URL to an image of the listing"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"String"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"location")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"A ",Object(r.b)("a",Object(a.a)({parentName:"td"},{href:"https://maps.google.com/pluscodes/"}),"Google Maps Plus Code")," for the location of the listing"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"String"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"wifi")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"The availability of WiFi at the listing"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"String"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"laundry")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"The availability of a Landry at the listing"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"String"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"hvac")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"The availability of an HVAC at the listing"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"String"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"tv")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"The availability of a TV at the listing"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"String"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"kitchen")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"The availability of a Kitchen at the listing"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"String"))))),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-ocaml"}),"transition create_listing (\n  name: String, description: String, price: Uint128,\n  rooms: Uint32, bathrooms: Uint32, image: String, location: String,\n  wifi: String, laundry: String, hvac: String, tv: String, kitchen: String\n)\n  user_exists_check <- exists user_name[_sender];\n  match user_exists_check with\n  | True =>\n    role <- user_role[_sender];\n    match role with\n    | Some role =>\n      user_role_check = builtin eq role user_role_host;\n      match user_role_check with\n      | True =>\n        id <- listing_id_generator;\n        current_block_number <- & BLOCKNUMBER;\n        listing_host[id] := _sender;\n        set_listing_details id name description price rooms bathrooms image location wifi laundry hvac tv kitchen;\n        listing_rented_till[id] := current_block_number;\n        listing_accumulated_rent[id] := zero;\n        next_listing_id = builtin add id one;\n        listing_id_generator := next_listing_id;\n        send_message zero listing_created\n      | False =>\n        send_message zero user_is_renter\n      end\n    | None =>\n      send_message zero user_does_not_exist\n    end\n  | False =>\n    send_message zero user_does_not_exist\n  end\nend\n")),Object(r.b)("br",null),Object(r.b)("h3",{id:"update_listing"},Object(r.b)("inlineCode",{parentName:"h3"},"update_listing")),Object(r.b)("p",null,"This transition is used by the host user to update the ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"dev-rentonzilliqa-mutable-variables#listing-details-fields"}),"Listing Details")," for the given listing."),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"_sender")," wallet address is checked if it is indeed the host of the listing."),Object(r.b)("p",null,"The ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"dev-rentonzilliqa-procedures#set_listing_details"}),Object(r.b)("inlineCode",{parentName:"a"},"set_listing_details"))," procedure is used to update the details."),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Arguments"),Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Description"),Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Type"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"id")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"The ID of the listing"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"Uint128"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"name")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"The name of the listing"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"String"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"description")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"The description of the listing"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"String"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"price")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"The price of the listing"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"Uint128"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"rooms")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"The number of rooms in the listing"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"Uint32"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"bathrooms")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"The number of bathrooms in the listing"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"Uint32"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"image")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"A URL to an image of the listing"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"String"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"location")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"A ",Object(r.b)("a",Object(a.a)({parentName:"td"},{href:"https://maps.google.com/pluscodes/"}),"Google Maps Plus Code")," for the location of the listing"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"String"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"wifi")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"The availability of WiFi at the listing"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"String"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"laundry")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"The availability of a Landry at the listing"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"String"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"hvac")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"The availability of an HVAC at the listing"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"String"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"tv")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"The availability of a TV at the listing"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"String"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"kitchen")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"The availability of a Kitchen at the listing"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"String"))))),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-ocaml"}),"transition update_listing (\n  id: Uint128, name: String, description: String, price: Uint128,\n  rooms: Uint32, bathrooms: Uint32, image: String, location: String,\n  wifi: String, laundry: String, hvac: String, tv: String, kitchen: String\n)\n  host <- listing_host[id];\n  match host with\n  | Some host =>\n    user_is_host_check = builtin eq host _sender;\n    match user_is_host_check with\n    | True =>\n      set_listing_details id name description price rooms bathrooms image location wifi laundry hvac tv kitchen;\n      send_message zero listing_updated\n    | False =>\n      send_message zero user_is_not_host\n    end\n  | None =>\n    send_message zero listing_does_not_exist\n  end\nend\n")),Object(r.b)("br",null),Object(r.b)("h3",{id:"delete_listing"},Object(r.b)("inlineCode",{parentName:"h3"},"delete_listing")),Object(r.b)("p",null,"This transition is used by the host user to delete a particular listing."),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"_sender")," wallet address is checked if it is indeed the host of the listing."),Object(r.b)("p",null,"It checks if the accumulated rent for the listing is empty."),Object(r.b)("p",null,"The ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"dev-rentonzilliqa-procedures#delete_listing_by_id"}),Object(r.b)("inlineCode",{parentName:"a"},"delete_listing_by_id"))," procedure is used to delete the listing."),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Arguments"),Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Description"),Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Type"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"id")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"The ID of the listing"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"Uint128"))))),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-ocaml"}),"transition delete_listing (id: Uint128)\n  host <- listing_host[id];\n  match host with\n  | Some host =>\n    user_is_host_check = builtin eq host _sender;\n    match user_is_host_check with\n    | True =>\n      accumulated_rent_value <- listing_accumulated_rent[id];\n      match accumulated_rent_value with\n      | Some accumulated_rent_value =>\n        no_rent = builtin eq accumulated_rent_value zero;\n        match no_rent with\n        | True =>\n          delete_listing_by_id id;\n          send_message zero listing_deleted\n        | False =>\n          send_message zero rent_not_empty\n        end\n      | None =>\n        send_message zero listing_details_missing\n      end\n    | False =>\n      send_message zero user_is_not_host\n    end\n  | None =>\n    send_message zero listing_does_not_exist\n  end\nend\n")),Object(r.b)("br",null),Object(r.b)("h3",{id:"book_listing"},Object(r.b)("inlineCode",{parentName:"h3"},"book_listing")),Object(r.b)("p",null,"This transition is used by a renter user to book a listing."),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"_sender")," wallet address is checked to ensure it is not the host of the listing."),Object(r.b)("p",null,"The ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"dev-rentonzilliqa-procedures#check_listing_available"}),Object(r.b)("inlineCode",{parentName:"a"},"check_listing_available")),", ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"dev-rentonzilliqa-procedures#check_amount_and_book"}),Object(r.b)("inlineCode",{parentName:"a"},"check_amount_and_book")),", and ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"dev-rentonzilliqa-procedures#book_listing_by_id"}),Object(r.b)("inlineCode",{parentName:"a"},"book_listing_by_id"))," procedures are used in sequence to book the listing."),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Arguments"),Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Description"),Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Type"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"id")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"The ID of the listing"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"Uint128"))))),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-ocaml"}),"transition book_listing (id: Uint128)\n  user_exists_check <- exists user_name[_sender];\n  match user_exists_check with\n  | True =>\n    host <- listing_host[id];\n    match host with\n    | Some host =>\n      user_is_host_check = builtin eq host _sender;\n      match user_is_host_check with\n      | True =>\n        send_message zero user_is_host\n      | False =>\n        check_listing_available id\n      end\n    | None =>\n      send_message zero listing_does_not_exist\n    end\n  | False =>\n    send_message zero user_does_not_exist\n  end\nend\n")),Object(r.b)("br",null),Object(r.b)("h3",{id:"claim_rent"},Object(r.b)("inlineCode",{parentName:"h3"},"claim_rent")),Object(r.b)("p",null,"This transition is used by a host user to claim the accumulated rent from a listing that they own."),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"_sender")," wallet address is checked to ensure it is indeed the host of the listing."),Object(r.b)("p",null,"The ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"dev-rentonzilliqa-procedures#claim_rent_by_id"}),Object(r.b)("inlineCode",{parentName:"a"},"claim_rent_by_id"))," procedure is used to claim the rent."),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Arguments"),Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Description"),Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Type"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"id")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"The ID of the listing"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"Uint128"))))),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-ocaml"}),"transition claim_rent (id: Uint128)\n  user_exists_check <- exists user_name[_sender];\n  match user_exists_check with\n  | True =>\n    host <- listing_host[id];\n    match host with\n    | Some host =>\n      user_is_host_check = builtin eq host _sender;\n      match user_is_host_check with\n      | True =>\n        claim_rent_by_id id\n      | False =>\n        send_message zero user_is_not_host\n      end\n    | None =>\n      send_message zero listing_does_not_exist\n    end\n  | False =>\n    send_message zero user_does_not_exist\n  end\nend\n")),Object(r.b)("br",null),Object(r.b)("h2",{id:"owner-transitions"},"Owner Transitions"),Object(r.b)("p",null,"This group of transitions is used by the owner to manage the platform."),Object(r.b)("h3",{id:"claim_commission"},Object(r.b)("inlineCode",{parentName:"h3"},"claim_commission")),Object(r.b)("p",null,"This transition is used to claim the commission collected on the platform."),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"_sender")," wallet address is checked to ensure it is the owner of the contract."),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"_balance")," from the contract is sent to the owner via a message."),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-ocaml"}),"transition claim_commission ()\n  is_owner = builtin eq owner _sender;\n  match is_owner with\n  | False =>\n    send_message zero user_is_not_owner\n  | True =>\n    balance <- _balance;\n    send_message balance commission_claimed\n  end\nend\n")),Object(r.b)("br",null),Object(r.b)("h3",{id:"update_commission"},Object(r.b)("inlineCode",{parentName:"h3"},"update_commission")),Object(r.b)("p",null,"This transition is used to update the commission collected from each rental."),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"_sender")," wallet address is checked to ensure it is the owner of the contract."),Object(r.b)("p",null,"The ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"dev-rentonzilliqa-mutable-variables#owner-fields"}),Object(r.b)("inlineCode",{parentName:"a"},"owners-commission"))," field is updated to ",Object(r.b)("inlineCode",{parentName:"p"},"new_commission"),"."),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Arguments"),Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Description"),Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Type"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"new_commission")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"A new value for the commission"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"Uint128"))))),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-ocaml"}),"transition update_commission (new_commission: Uint128)\n  is_owner = builtin eq owner _sender;\n  match is_owner with\n  | False =>\n    send_message zero user_is_not_owner\n  | True =>\n    owners_commission := new_commission;\n    send_message zero commission_updated\n  end\nend\n")),Object(r.b)("br",null),Object(r.b)("h3",{id:"update_night_duration"},Object(r.b)("inlineCode",{parentName:"h3"},"update_night_duration")),Object(r.b)("p",null,"This transition is used to update the night duration value that is added to the ",Object(r.b)("inlineCode",{parentName:"p"},"BLOCKNUMBER")," to create the notion of time."),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"_sender")," wallet address is checked to ensure it is the owner of the contract."),Object(r.b)("p",null,"The ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"dev-rentonzilliqa-mutable-variables#owner-fields"}),Object(r.b)("inlineCode",{parentName:"a"},"night_duration"))," field is updated to ",Object(r.b)("inlineCode",{parentName:"p"},"new_night_duration"),"."),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Arguments"),Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Description"),Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Type"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"new_night_duration")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"A new value for the night duration"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"Uint32"))))),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-ocaml"}),"transition update_night_duration (new_night_duration: Uint32)\n  is_owner = builtin eq owner _sender;\n  match is_owner with\n  | False =>\n    send_message zero user_is_not_owner\n  | True =>\n    night_duration := new_night_duration;\n    send_message zero night_duration_updated\n  end\nend\n")))}o.isMDXComponent=!0},298:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return j}));var a=n(0),i=n.n(a);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=i.a.createContext({}),o=function(e){var t=i.a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},d=function(e){var t=o(e.components);return i.a.createElement(s.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return i.a.createElement(i.a.Fragment,{},t)}},O=i.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,b=e.parentName,s=c(e,["components","mdxType","originalType","parentName"]),d=o(n),O=a,j=d["".concat(b,".").concat(O)]||d[O]||m[O]||r;return n?i.a.createElement(j,l(l({ref:t},s),{},{components:n})):i.a.createElement(j,l({ref:t},s))}));function j(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,b=new Array(r);b[0]=O;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:a,b[1]=l;for(var s=2;s<r;s++)b[s]=n[s];return i.a.createElement.apply(null,b)}return i.a.createElement.apply(null,n)}O.displayName="MDXCreateElement"}}]);