(window.webpackJsonp=window.webpackJsonp||[]).push([[110],{213:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return o})),a.d(t,"metadata",(function(){return l})),a.d(t,"rightToc",(function(){return b})),a.d(t,"default",(function(){return d}));var n=a(2),r=a(6),i=(a(0),a(257)),o={id:"staking-delegator-operations",title:"Smart Contract Operations",keywords:["staking","ssn","smart contract","zilliqa","delegator","delegation"],description:"Smart contract operations"},l={id:"staking/phase1/delegator/staking-delegator-operations",isDocsHomePage:!1,title:"Smart Contract Operations",description:"Smart contract operations",source:"@site/docs/staking/phase1/delegator/staking-delegator-operations.md",permalink:"/docs/staking/phase1/delegator/staking-delegator-operations",editUrl:"https://github.com/Zilliqa/dev-portal/tree/master/docs/staking/phase1/delegator/staking-delegator-operations.md",sidebar:"StakingSidebar",previous:{title:"Reading Contract States",permalink:"/docs/staking/phase1/delegator/staking-delegator-reading-contract-states"},next:{title:"gZIL Tokens",permalink:"/docs/staking/phase1/delegator/staking-delegator-gzil"}},b=[{value:"Representation of Values in the Smart Contract",id:"representation-of-values-in-the-smart-contract",children:[]},{value:"Delegate Stake",id:"delegate-stake",children:[{value:"Description",id:"description",children:[]},{value:"Parameters",id:"parameters",children:[]},{value:"Transition",id:"transition",children:[]},{value:"Sample Code",id:"sample-code",children:[]}]},{value:"Withdraw Stake Rewards and gZIL",id:"withdraw-stake-rewards-and-gzil",children:[{value:"Description",id:"description-1",children:[]},{value:"Parameters",id:"parameters-1",children:[]},{value:"Transition",id:"transition-1",children:[]},{value:"Sample Code",id:"sample-code-1",children:[]}]},{value:"Withdraw Stake Amount",id:"withdraw-stake-amount",children:[{value:"Description",id:"description-2",children:[]},{value:"Parameters",id:"parameters-2",children:[]},{value:"Transition",id:"transition-2",children:[]},{value:"Sample Code",id:"sample-code-2",children:[]}]},{value:"Complete Withdrawal",id:"complete-withdrawal",children:[{value:"Description",id:"description-3",children:[]},{value:"Parameters",id:"parameters-3",children:[]},{value:"Transition",id:"transition-3",children:[]},{value:"Sample code",id:"sample-code-3",children:[]}]},{value:"Stake Amount Redelegation",id:"stake-amount-redelegation",children:[{value:"Description",id:"description-4",children:[]},{value:"Parameters",id:"parameters-4",children:[]},{value:"Transition",id:"transition-4",children:[]},{value:"Sample Code",id:"sample-code-4",children:[]}]}],c={rightToc:b};function d(e){var t=e.components,a=Object(r.a)(e,["components"]);return Object(i.b)("wrapper",Object(n.a)({},c,a,{components:t,mdxType:"MDXLayout"}),Object(i.b)("hr",null),Object(i.b)("p",null,"The operations available to the delegator on the smart contract are as follows:"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},Object(i.b)("a",Object(n.a)({parentName:"li"},{href:"#delegate-stake"}),"Delegate stake")),Object(i.b)("li",{parentName:"ol"},Object(i.b)("a",Object(n.a)({parentName:"li"},{href:"#withdraw-stake-rewards-and-gzil"}),"Withdraw stake rewards and gZIL")),Object(i.b)("li",{parentName:"ol"},Object(i.b)("a",Object(n.a)({parentName:"li"},{href:"#withdraw-stake-amount"}),"Withdraw stake amount")),Object(i.b)("li",{parentName:"ol"},Object(i.b)("a",Object(n.a)({parentName:"li"},{href:"#complete-withdrawal"}),"Complete withdrawal")),Object(i.b)("li",{parentName:"ol"},Object(i.b)("a",Object(n.a)({parentName:"li"},{href:"#stake-amount-redelegation"}),"Stake amount redelegation"))),Object(i.b)("h2",{id:"representation-of-values-in-the-smart-contract"},"Representation of Values in the Smart Contract"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"_amount")," and ",Object(i.b)("inlineCode",{parentName:"p"},"amt")," are represented in ",Object(i.b)("inlineCode",{parentName:"p"},"Qa"),", where 1 ",Object(i.b)("inlineCode",{parentName:"p"},"ZIL")," = 1 * 1E12 ",Object(i.b)("inlineCode",{parentName:"p"},"Qa"),"."),Object(i.b)("h2",{id:"delegate-stake"},"Delegate Stake"),Object(i.b)("h3",{id:"description"},"Description"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"DelegateStake")," accepts $ZIL deposit and delegates stake to the SSN identified by ",Object(i.b)("inlineCode",{parentName:"p"},"ssnaddr"),"."),Object(i.b)("p",null,"In case of failure to accept the stake, an ",Object(i.b)("inlineCode",{parentName:"p"},"exception")," will be thrown and the transaction will be reverted. This stake will be buffered if the SSN is already active else it will be added to the stake pool of the SSN. The transition should throw an error in case the amount being delegated is less than ",Object(i.b)("inlineCode",{parentName:"p"},"mindelegstake"),"."),Object(i.b)("div",{className:"admonition admonition-info alert alert--info"},Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(i.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"})))),"info")),Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("p",{parentName:"div"},"Due to the non-custodial nature of the phase 1 staking program, only the owner of the wallet will be able to withdraw the stake amount and stake reward. The SSN operator will not have access to the fund."))),Object(i.b)("h3",{id:"parameters"},"Parameters"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"_amount"),": the stake amount to be deposited into the smart contract",Object(i.b)("br",{parentName:"p"}),"\n",Object(i.b)("inlineCode",{parentName:"p"},"ssnaddr"),": the SSN to delegate to"),Object(i.b)("h3",{id:"transition"},"Transition"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{}),"transition DelegateStake(ssnaddr: ByStr20) \n")),Object(i.b)("h3",{id:"sample-code"},"Sample Code"),Object(i.b)("table",null,Object(i.b)("thead",{parentName:"table"},Object(i.b)("tr",{parentName:"thead"},Object(i.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Language"),Object(i.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Link to Sample Code"))),Object(i.b)("tbody",{parentName:"table"},Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"NodeJS"),Object(i.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"coming soon")),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Java"),Object(i.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"coming soon")),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Golang"),Object(i.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"coming soon")))),Object(i.b)("h2",{id:"withdraw-stake-rewards-and-gzil"},"Withdraw Stake Rewards and gZIL"),Object(i.b)("h3",{id:"description-1"},"Description"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"WithdrawStakeRewards")," withdraws the delegator's stake rewards ($ZIL and ",Object(i.b)("inlineCode",{parentName:"p"},"gZIL"),") from an SSN. If gZIL issuance is still ongoing, for every 1 $ZIL stake reward given, the delegator will receive 0.001 ",Object(i.b)("inlineCode",{parentName:"p"},"gZIL"),"."),Object(i.b)("div",{className:"admonition admonition-info alert alert--info"},Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(i.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"})))),"info")),Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("p",{parentName:"div"},"If the delegator delegates to multiple SSNs and wishes to withdraw all rewards from SSNs, the user will need to call this transition multiple times, specifying a different SSN address each time."))),Object(i.b)("h3",{id:"parameters-1"},"Parameters"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"ssnaddr"),": the address of the SSN from which the delegator wishes to withdraw the reward from"),Object(i.b)("h3",{id:"transition-1"},"Transition"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{}),"transition WithdrawStakeRewards(ssnaddr: ByStr20)\n")),Object(i.b)("h3",{id:"sample-code-1"},"Sample Code"),Object(i.b)("table",null,Object(i.b)("thead",{parentName:"table"},Object(i.b)("tr",{parentName:"thead"},Object(i.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Language"),Object(i.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Link to Sample Code"))),Object(i.b)("tbody",{parentName:"table"},Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"NodeJS"),Object(i.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"coming soon")),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Java"),Object(i.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"coming soon")),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Golang"),Object(i.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"coming soon")))),Object(i.b)("h2",{id:"withdraw-stake-amount"},"Withdraw Stake Amount"),Object(i.b)("h3",{id:"description-2"},"Description"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"WithdrawStakeAmt")," is the first of two operations to withdraw the delegator's stake amount from an SSN. Upon successful calling of this transition, the withdrawn stake amount will enter an ",Object(i.b)("strong",{parentName:"p"},"unbonding")," state. The delegator will need to wait for 24,000 blocks (~2 weeks) before the delegator can successfully invoke ",Object(i.b)("inlineCode",{parentName:"p"},"CompleteWithdrawal")," transition to complete the withdrawal back to the delegator's wallet. When the stake amount is in unbonding state, it will not be eligible for any new rewards ($ZIL and/or gZIL)."),Object(i.b)("div",{className:"admonition admonition-info alert alert--info"},Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(i.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"})))),"info")),Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("p",{parentName:"div"},"If the delegator delegates to multiple SSNs and wishes to withdraw all rewards from SSNs, the user will need to call this transition multiple times, specifying a different SSN address each time."))),Object(i.b)("h3",{id:"parameters-2"},"Parameters"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"ssnaddr"),": the address of the SSN from which the delegator wishes to withdraw reward form\n",Object(i.b)("inlineCode",{parentName:"p"},"amt"),": the amount of stake amount to withdraw from the delegation to a particular SSN"),Object(i.b)("h3",{id:"transition-2"},"Transition"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{})," WithdrawStakeAmt(ssnaddr: ByStr20, amt: Uint128)\n")),Object(i.b)("h3",{id:"sample-code-2"},"Sample Code"),Object(i.b)("table",null,Object(i.b)("thead",{parentName:"table"},Object(i.b)("tr",{parentName:"thead"},Object(i.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Language"),Object(i.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Link to Sample Code"))),Object(i.b)("tbody",{parentName:"table"},Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"NodeJS"),Object(i.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"coming soon")),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Java"),Object(i.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"coming soon")),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Golang"),Object(i.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"coming soon")))),Object(i.b)("h2",{id:"complete-withdrawal"},"Complete Withdrawal"),Object(i.b)("h3",{id:"description-3"},"Description"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"CompleteWithdrawal")," is the second of two operations required for the withdrawal of delegator's stake amount from a SSN, The delegator will first need to invoke ",Object(i.b)("inlineCode",{parentName:"p"},"WithdrawStakeAmt")," transition successfully, wait for 24,000 blocks (~2 weeks) for unbonding of stake amount to be over, and finally call ",Object(i.b)("inlineCode",{parentName:"p"},"CompleteWithdrawal")," in a separate transaction to complete the withdrawal and receive the stake amount back into the delegator's wallet."),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"CompleteWithdrawal")," will iterate through all stake amount that has transitted to ",Object(i.b)("inlineCode",{parentName:"p"},"unbonding")," state, identify the amount that have completed the unbonding process and withdraw it back to delegator's wallet. This operation is agnostic to SSN."),Object(i.b)("h3",{id:"parameters-3"},"Parameters"),Object(i.b)("p",null,"None"),Object(i.b)("h3",{id:"transition-3"},"Transition"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{})," CompleteWithdrawal()\n")),Object(i.b)("h3",{id:"sample-code-3"},"Sample code"),Object(i.b)("table",null,Object(i.b)("thead",{parentName:"table"},Object(i.b)("tr",{parentName:"thead"},Object(i.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Language"),Object(i.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Link to Sample Code"))),Object(i.b)("tbody",{parentName:"table"},Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"NodeJS"),Object(i.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"coming soon")),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Java"),Object(i.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"coming soon")),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Golang"),Object(i.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"coming soon")))),Object(i.b)("h2",{id:"stake-amount-redelegation"},"Stake Amount Redelegation"),Object(i.b)("h3",{id:"description-4"},"Description"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"ReDelegateStake")," allows the delegator to transfer the stake amount from one SSN to another SSN. The stake amount will not enter unbonding state. However, buffering of stake amount may still apply."),Object(i.b)("h3",{id:"parameters-4"},"Parameters"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"ssnaddr"),": the existing SSN where the stake amount will be withdrawn from and transferred to a new SSN\n",Object(i.b)("inlineCode",{parentName:"p"},"to_ssn"),": the new SSN to accept the stake amount delegation\n",Object(i.b)("inlineCode",{parentName:"p"},"amount"),": the amount of the stake amount to transfer to the new SSN"),Object(i.b)("h3",{id:"transition-4"},"Transition"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{}),"transition ReDelegateStake(ssnaddr: ByStr20, to_ssn: ByStr20, amount: Uint128)\n")),Object(i.b)("h3",{id:"sample-code-4"},"Sample Code"),Object(i.b)("table",null,Object(i.b)("thead",{parentName:"table"},Object(i.b)("tr",{parentName:"thead"},Object(i.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Language"),Object(i.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Link to Sample Code"))),Object(i.b)("tbody",{parentName:"table"},Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"NodeJS"),Object(i.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"coming soon")),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Java"),Object(i.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"coming soon")),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Golang"),Object(i.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"coming soon")))))}d.isMDXComponent=!0},257:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return O}));var n=a(0),r=a.n(n);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function b(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var c=r.a.createContext({}),d=function(e){var t=r.a.useContext(c),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},s=function(e){var t=d(e.components);return r.a.createElement(c.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},m=r.a.forwardRef((function(e,t){var a=e.components,n=e.mdxType,i=e.originalType,o=e.parentName,c=b(e,["components","mdxType","originalType","parentName"]),s=d(a),m=n,O=s["".concat(o,".").concat(m)]||s[m]||p[m]||i;return a?r.a.createElement(O,l(l({ref:t},c),{},{components:a})):r.a.createElement(O,l({ref:t},c))}));function O(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=a.length,o=new Array(i);o[0]=m;var l={};for(var b in t)hasOwnProperty.call(t,b)&&(l[b]=t[b]);l.originalType=e,l.mdxType="string"==typeof e?e:n,o[1]=l;for(var c=2;c<i;c++)o[c]=a[c];return r.a.createElement.apply(null,o)}return r.a.createElement.apply(null,a)}m.displayName="MDXCreateElement"}}]);