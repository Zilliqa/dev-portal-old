<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.58">
<link rel="search" type="application/opensearchdescription+xml" title="Zilliqa Developer Portal" href="/opensearch.xml"><title data-react-helmet="true">Blacklist | Zilliqa Developer Portal</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Blacklist | Zilliqa Developer Portal"><meta data-react-helmet="true" name="description" content="Core protocol design - blacklisting."><meta data-react-helmet="true" property="og:description" content="Core protocol design - blacklisting."><meta data-react-helmet="true" name="keywords" content="core,blacklist"><meta data-react-helmet="true" property="og:url" content="https://dev.zilliqa.com/docs/contributors/core-blacklist"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://dev.zilliqa.com/docs/contributors/core-blacklist"><link rel="stylesheet" href="/styles.90e6c070.css">
<link rel="preload" href="/styles.f8d9a611.js" as="script">
<link rel="preload" href="/runtime~main.b40fb747.js" as="script">
<link rel="preload" href="/main.cb032903.js" as="script">
<link rel="preload" href="/1.aa7ebd33.js" as="script">
<link rel="preload" href="/2.abe3e410.js" as="script">
<link rel="preload" href="/197.103ece6a.js" as="script">
<link rel="preload" href="/198.e96451e6.js" as="script">
<link rel="preload" href="/20ac7829.7df63fe7.js" as="script">
<link rel="preload" href="/17896441.1e72046e.js" as="script">
<link rel="preload" href="/9a6cd4ea.0546bb4f.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo.png" alt="Zilliqa Logo"><strong class="navbar__title">Zilliqa Developer Portal</strong></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/basics/basics-intro-blockchain">Basics</a><a class="navbar__item navbar__link" href="/docs/dev/dev-started-introduction">Developers</a><a class="navbar__item navbar__link" href="/docs/apis/api-introduction">APIs</a><a class="navbar__item navbar__link" href="/docs/miners/mining-getting-started">Miners</a><a class="navbar__item navbar__link" href="/docs/exchanges/exchange-getting-started">Exchanges</a><a class="navbar__item navbar__link" href="/docs/staking/staking-overview">Staking</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/contributors/contribute-buildzil">Contributors</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><div class="navbar__search"><div class="searchWrapper_-F3-"><span aria-label="expand searchbar" role="button" class="searchIconButton_1Dnz" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_2eto"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo.png" alt="Zilliqa Logo"><strong class="navbar__title">Zilliqa Developer Portal</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/basics/basics-intro-blockchain">Basics</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/dev/dev-started-introduction">Developers</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/apis/api-introduction">APIs</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/miners/mining-getting-started">Miners</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/exchanges/exchange-getting-started">Exchanges</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/staking/staking-overview">Staking</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/contributors/contribute-buildzil">Contributors</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp" role="complementary"><div class="sidebar_1kLs"><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Contributors</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/contributors/contribute-buildzil">Building Zilliqa</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/contributors/contribute-guidelines">Contribution Guidelines</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/contributors/contribute-standards">Protocol Standards</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/contributors/contribute-bug-bounty">Bug Bounty Program</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Core Protocol Design</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Design Overview</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/contributors/core-node-operation">General Node Operation</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Consensus Layer</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/contributors/core-consensus">Consensus</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/contributors/core-multisignatures">Multisignatures</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Network Layer</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/contributors/core-gossip">Gossip</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/contributors/core-broadcasting">Broadcasting</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/contributors/core-blacklist">Blacklist</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/contributors/core-messaging-limits">Messaging Limits</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Messaging Layer</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/contributors/core-message-dispatch">Message Dispatch and Processing</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/contributors/core-message-queues">Message Queues and Jobs</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Data Layer</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/contributors/core-accounts">Account Management</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/contributors/core-transaction-lifecycle">Transaction Lifecycle</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/contributors/core-incremental-db">Incremental DB</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/contributors/core-scilla-operation">Scilla Operation</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Directory Service</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/contributors/core-ds-mimo">DS MIMO</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/contributors/core-ds-reputation">DS Reputation</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Lookup</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/contributors/core-isolated-server">Isolated Server</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/contributors/core-websocket-server">WebSocket Server</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/contributors/core-transaction-dispatch">Transaction Dispatch</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/contributors/core-multipliers">Multipliers</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Mining</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/contributors/core-pow">PoW Algorithm</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/contributors/core-difficulty-adjustment">Difficulty Adjustment</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/contributors/core-por">Proof of Reputation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/contributors/core-coinbase">Coinbase Rewards</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/contributors/core-global-gas-price">Global Gas Price</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Mitigation Measures</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/contributors/core-guard-mode">Guard Mode</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/contributors/core-rejoin-mechanism">Rejoin Mechanism</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/contributors/core-view-change">View Change</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/contributors/core-diagnostic-data">Diagnostic Data</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/contributors/core-status-server">Status Server</a></li></ul></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="container padding-vert--lg docItemWrapper_1cc7"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">Blacklist</h1></header><div class="markdown"><hr><p>Zilliqa has a blacklisting feature implemented in <code>libNetwork</code>. The idea is to keep track of IP addresses of peers that, for conditions listed below, can potentially disrupt the operation of the node. Once blacklisted, the peer is effectively excluded from further interactions with the node.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="blacklisting-conditions"></a>Blacklisting Conditions<a aria-hidden="true" tabindex="-1" class="hash-link" href="#blacklisting-conditions" title="Direct link to heading">#</a></h2><ul><li>Socket write failure (according to <code>P2PComm::IsHostHavingNetworkIssue</code>)</li><li>Socket connect failure (according to <code>P2PComm::IsHostHavingNetworkIssue</code>)</li><li>Gossip message from peer exceeds <code>MAX_GOSSIP_MSG_SIZE_IN_BYTES</code></li><li>Bytes read from peer exceeds <code>MAX_READ_WATERMARK_IN_BYTES</code></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="blacklist-checking"></a>Blacklist Checking<a aria-hidden="true" tabindex="-1" class="hash-link" href="#blacklist-checking" title="Direct link to heading">#</a></h2><p>Outgoing</p><ul><li><code>Lookup::SendMessageToRandomSeedNode</code></li><li><code>P2PComm::SendMessageNoQueue</code></li><li><code>SendJob::SendMessageCore</code></li><li><code>SendJobPeer::DoSend</code></li><li><code>SendJobPeers&lt;T&gt;::DoSend</code></li></ul><p>Incoming</p><ul><li><code>P2PComm::AcceptConnectionCallback</code></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="blacklist-exemptions"></a>Blacklist Exemptions<a aria-hidden="true" tabindex="-1" class="hash-link" href="#blacklist-exemptions" title="Direct link to heading">#</a></h2><p>Adding exclusion privilege</p><ol><li>DS guards<ul><li>When <code>NEWDSGUARDNETWORKINFO</code> is received (new IP)</li><li>Whenever DS committee is updated</li></ul></li><li>Lookup nodes<ul><li>Every time a message is sent out</li></ul></li><li>Manual addition of an IP using <code>miner_info.py whitelist_add</code></li></ol><p>Removing exclusion privilege</p><ol><li>DS guards<ul><li>When <code>NEWDSGUARDNETWORKINFO</code> is received (old IP)</li></ul></li><li>Manual removal of an IP using <code>miner_info.py whitelist_remove</code></li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="blacklist-removal-and-clearing"></a>Blacklist Removal and Clearing<a aria-hidden="true" tabindex="-1" class="hash-link" href="#blacklist-removal-and-clearing" title="Direct link to heading">#</a></h2><ul><li>Non-lookup nodes remove <code>BLACKLIST_NUM_TO_POP</code> number of peers from the blacklist at the start of the DS epoch</li><li>Non-lookup nodes also remove all blacklisted seed nodes from the blacklist at the start of the DS epoch</li><li>Lookup nodes clear the entire blacklist upon receiving the DS Block</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="blacklist-enabling"></a>Blacklist Enabling<a aria-hidden="true" tabindex="-1" class="hash-link" href="#blacklist-enabling" title="Direct link to heading">#</a></h2><p>Blacklist is enabled by default, and is only temporarily disabled when doing node recovery (<code>RECOVERY_ALL_SYNC</code>). In that situation, the blacklist is re-enabled once the Tx block is processed.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="relaxed-blacklist"></a>Relaxed Blacklist<a aria-hidden="true" tabindex="-1" class="hash-link" href="#relaxed-blacklist" title="Direct link to heading">#</a></h2><p>A peer can become unreachable if it temporarily goes down. In this case, socket connections to that peer would usually return <code>EHOSTDOWN</code> or <code>ECONNREFUSED</code> as the error message. When this occurs, we avoid blacklisting the peer in the &quot;strict&quot; sense as in the previously listed <a href="#blacklisting-conditions">conditions</a>. Instead, we blacklist the peer in the &quot;relaxed&quot; category.</p><p>While all incoming and outgoing messages from/to a peer that is strictly blacklisted are blocked, only outgoing messages to the peer are blocked for a peer that is in the relaxed blacklist. This allows the peer to have itself be removed from everyone&#x27;s blacklist by sending the request for removal once it has come back online. Such a request will be accepted if the peer is found to be in the relaxed blacklist.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/Zilliqa/dev-portal/tree/master/docs/contributors/core-blacklist.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/contributors/core-broadcasting"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Broadcasting</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/contributors/core-messaging-limits"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Messaging Limits »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#blacklisting-conditions" class="table-of-contents__link">Blacklisting Conditions</a></li><li><a href="#blacklist-checking" class="table-of-contents__link">Blacklist Checking</a></li><li><a href="#blacklist-exemptions" class="table-of-contents__link">Blacklist Exemptions</a></li><li><a href="#blacklist-removal-and-clearing" class="table-of-contents__link">Blacklist Removal and Clearing</a></li><li><a href="#blacklist-enabling" class="table-of-contents__link">Blacklist Enabling</a></li><li><a href="#relaxed-blacklist" class="table-of-contents__link">Relaxed Blacklist</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Developer Groups</h4><ul class="footer__items"><li class="footer__item"><a href="https://discord.com/invite/XMRE9tt" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li><li class="footer__item"><a href="https://t.me/ZilliqaDevs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Telegram</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Social</h4><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/zilliqa" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UCvinnFbf0u71cajoxKcfZIQ" target="_blank" rel="noopener noreferrer" class="footer__link-item">Youtube</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Other Links</h4><ul class="footer__items"><li class="footer__item"><a href="https://blog.zilliqa.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li><li class="footer__item"><a href="https://github.com/zilliqa" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="text--center"><div>Copyright © 2019 Zilliqa Research Pte. Ltd.</div></div></div></footer></div>
<script src="/styles.f8d9a611.js"></script>
<script src="/runtime~main.b40fb747.js"></script>
<script src="/main.cb032903.js"></script>
<script src="/1.aa7ebd33.js"></script>
<script src="/2.abe3e410.js"></script>
<script src="/197.103ece6a.js"></script>
<script src="/198.e96451e6.js"></script>
<script src="/20ac7829.7df63fe7.js"></script>
<script src="/17896441.1e72046e.js"></script>
<script src="/9a6cd4ea.0546bb4f.js"></script>
</body>
</html>